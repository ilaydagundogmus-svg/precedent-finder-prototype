<!doctype html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Yargıtay Karar Arama Sistemi</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 24px; background: #fff; }
      .container { max-width: 980px; margin: 0 auto; }
      h1 { margin: 0 0 14px; font-size: 40px; letter-spacing: -0.02em; }
      .sub { color: #444; margin: 0 0 18px; }
      .card { border: 1px solid #e6e6e6; border-radius: 16px; padding: 16px; margin: 12px 0; background: #fff; }
      .meta { font-size: 12px; color: #666; margin-bottom: 10px; }
      pre { white-space: pre-wrap; margin: 0; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; font-size: 13px; }
      textarea {
        width: 100%;
        min-height: 150px;
        padding: 14px 16px;
        border-radius: 14px;
        border: 1px solid #e3e3e3;
        font-size: 14px;
        line-height: 1.5;
        resize: vertical;
        outline: none;
      }
      textarea:focus { border-color: #c9c9c9; }
      .row { display: flex; gap: 12px; align-items: center; margin: 14px 0; }
      .btn {
        padding: 12px 14px;
        border-radius: 14px;
        border: 1px solid #d9d9d9;
        background: #f6f6f6;
        cursor: pointer;
        font-weight: 600;
      }
      .btn:active { transform: translateY(1px); }
      .status { font-size: 13px; color: #666; }
      .section-title { margin: 18px 0 8px; font-size: 16px; color: #111; font-weight: 700; }
      .hint { font-size: 12px; color: #666; margin: 8px 0 0; }
      hr { border: none; border-top: 1px solid #eee; margin: 18px 0; }
    


      .layout { display: grid; grid-template-columns: 300px 1fr; gap: 18px; align-items: start; }
.sidebar .card { position: sticky; top: 18px; }
.label { font-size: 12px; color: #666; margin: 10px 0 6px; }
select, input[type="text"] {
  width: 100%;
  padding: 10px 12px;
  border-radius: 12px;
  border: 1px solid #e3e3e3;
  font-size: 14px;
}
    
    </style>


  </head>

  <body>
    <div class="container">
      <h1>Yargıtay Karar Arama Sistemi</h1>
      <p class="sub">Dava özetinizi yazın ve benzer kararları listeleyin.</p>



      
      <div class="layout">
        <!-- LEFT: Filters (UI-only) -->
        <div class="sidebar">
          <div class="card">
            <div class="section-title">Filtrele</div>
      
            <div class="label">Yıl</div>
            <select id="yearFilter">
              <option value="">Tüm Yıllar</option>
              <option>2025</option>
              <option>2024</option>
              <option>2023</option>
              <option>2022</option>
              <option>2021</option>
            </select>
      
            <div class="label">Daire</div>
            <select id="chamberFilter">
              <option value="">Tümü</option>
              <option>11. HD</option>
              <option>19. HD</option>
            </select>
      
            <div class="label">Konu</div>
            <select id="topicFilter">
              <option value="">Haksız Rekabet</option>
              <option>Yanıltıcı Reklam</option>
              <option>Taklit / İltibas</option>
              <option>Ticari İtibar</option>
            </select>
      
            <div class="label">Karar Numarası</div>
            <input id="decisionNo" type="text" placeholder="Örn: 2023/1234" />
          </div>
        </div>
      
        <!-- RIGHT: Main -->
        <div class="main" id="mainCol">
          <!-- Buraya mevcut arama kartını ve sonuçları koyacağız -->
        </div>
      </div>
      









      <div class="card">
        <div class="section-title">Dava Detaylarını Açıklayın</div>
        <textarea
          id="caseInput"
          placeholder="Örn: Rakip şirket, yanıltıcı reklamlarla ürünlerimizi taklit ederek müşteri çevremizi kendisine çekiyor. TTK 54 kapsamında haksız rekabet olduğunu düşünüyoruz. Bu konuda emsal karar arıyorum."
        ></textarea>
        <p class="hint">Kişisel veri (isim, T.C. kimlik, adres, telefon) girmeyin.</p>

        <div class="row">
          <button class="btn" id="searchBtn">Karar Ara</button>
          <span class="status" id="searchStatus"></span>
        </div>
      </div>

      <hr />

      <div class="section-title">İlgili Kararlar</div>
      <div id="list"></div>
    </div>

    <script>
      const listEl = document.getElementById("list");
      const caseInputEl = document.getElementById("caseInput");
      const searchBtn = document.getElementById("searchBtn");
      const searchStatusEl = document.getElementById("searchStatus");

      searchBtn.addEventListener("click", async () => {
        const caseText = caseInputEl.value.trim();
        searchStatusEl.textContent = "Aranıyor...";
        listEl.innerHTML = "";

        try {
          const res = await fetch("http://localhost:3001/search", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ caseText }),
          });
          if (!res.ok) throw new Error("HTTP " + res.status);

          const data = await res.json();
          const results = data.results || [];

          searchStatusEl.textContent = `${results.length} karar bulundu.`;

          if (results.length === 0) {
            listEl.innerHTML = "<div class='card'>Sonuç bulunamadı.</div>";
            return;
          }

          for (const item of results) {
            const card = document.createElement("div");
            card.className = "card";
            card.innerHTML = `
              <div class="meta">${escapeHtml(item.filename)}</div>
              <pre>${escapeHtml(item.text)}</pre>
            `;
            listEl.appendChild(card);
          }
        } catch (err) {
          console.error(err);
          searchStatusEl.textContent = "Arama başarısız. (Backend çalışıyor mu?)";
          listEl.innerHTML = "<div class='card'>Kararlar alınamadı.</div>";
        }
      });

      function escapeHtml(str) {
        return String(str)
          .replaceAll("&", "&amp;")
          .replaceAll("<", "&lt;")
          .replaceAll(">", "&gt;");
      }
    </script>
  </body>
</html>
